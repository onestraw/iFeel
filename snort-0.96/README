Snort                                                                  12/21/98

Martin Roesch
roesch@clark.net or mroesch@bbn.com

******************************************************************************
COPYRIGHT

Copyright (C)1998 Martin Roesch

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.

Some of this code has been taken from tcpdump, which was developed
by the Network Research Group at Lawrence Berkeley National Lab,
and is copyrighted by the University of California Regents.

******************************************************************************

DESCRIPTION

This program is meant to be a packet logger but is useful for other things.  As
a packet logger, it can become sort of a "poor man's Intrusion Detection 
System" in that you can collect traffic of interest for later (manual) 
examination.  It can also function as just a packet plain sniffer, decoding IP,
TCP, UDP, ICMP and ARP traffic.  Major chunks of Mike Borella's IP-Grab program
were analyzed and twisted into what you have before you, if you want to see a
nicely done (i.e. instructional) example of libpcap programming check out his
webpage at http://www.xnet.com/~cathmike/MSB.
 
Suggestions are encouraged and bug-fixes are always welcome. 

******************************************************************************

INSTALLATION

You must have the pcap library (libpcap) version 0.3 or greater
installed.  In particular, the pcap.h and net/bpf.h files must be 
in an appropriate include directory (just grabbing a pre-compiled 
libpcap.so won't cut it).  Download pcap from http://www-nrg.ee.lbl.gov.

Run the configure script to create a Makefile, then type 'make'.  If
you need to install any other libraries or headers, configure should
tell you.

Systems tested so far: Linux, FreeBSD, Solaris 2.6 (x86), Solaris
2.5.1(Sparc).

******************************************************************************

USAGE

snort -[options] <filter commands>

[options]
	-a	Display ARP datagrams
	-d	Display the application layer data of the packet in a nice
	        "debug-style" display
	-h <hn> Set the Home Network to <hn>.  This should be an IP address of
	        the "network of interest", the network you're interested in 
	        watching data go *to*.  For example, class C network 192.168.1
	        would be noted as 192.168.1.0, and class B network 192.168
	        would be denoted as 192.168.0.0.  This option isn't essential
	        to the proper function of the software, but it gives you a
	        little bit nicer output to the log files and screen.
	-i <if> Listen on interface <if>.  There are defaults specified for
	        the OS's I have in my home and office, but that may not match
	        what you've got...
	-l <ld> Log packets to directory <ld>.  Packets will be logged to the 
	        specified directory in subdirectories generated by the source
	        IP addresses of the connection computers (i.e. the foreign
	        hosts sending data on to your network of interest).
	-n <i>  Collect <i> packets and exit.
	-v	Be verbose.  Dumps packets to the screen.
	-V	Show the version number and exit.
	-?	Show the usage line and exit.

<filter commands>
	You may send filter commands to the program ala' TCPDUMP.  See that
program's documentation for a description on how to use them.

Example:
	To log all activity to network 192.168.1 in the /log directory:

	snort -h 192.168.1.0 -l /log net 192.168.1

	To act like a plain old sniffer and display all packets to the screen:
	
	snort -d -v

	To record all web traffic on your local network

	snort -h 192.168.1.0 -l /log net 192.168.1 and port 80

******************************************************************************

THANKS

Mike Borella for his nice libpcap tutorial.

******************************************************************************



